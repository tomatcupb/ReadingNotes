# 数据库基础理论
## 1. 事务(transaction)所应该具有的四个特性
## 1.1  原子性（Atomicity）  
原子性是指事务是一个不可再分割的工作单位，事务中的操作要么都发生，要么都不发生。
## 1.2 一致性（Consistency）
一致性是指在事务开始之前和事务结束以后，数据库的完整性约束没有被破坏。
这是说数据库事务不能破坏关系数据的完整性以及业务逻辑上的一致性。
## 1.3 隔离性（Isolation）
多个事务并发访问时，事务之间是隔离的，一个事务不应该影响其它事务运行效果。
### 1.3.1 事务之间的相互影响
1. 脏读  
意味着一个事务读取了另一个事务未提交的数据，而这个数据是有可能回滚的
1. 不可重复读  
意味着在数据库访问中，一个事务范围内两个相同的查询却返回了不同数据。这是由于查询时系统中其他事务修改的提交而引起的。
1. 幻读[mysql 幻读的详解、实例及解决办法](https://segmentfault.com/a/1190000016566788?utm_source=tag-newest#item-2)  
    是指当事务不是独立执行时发生的一种现象，例如第一个事务对一个表中的数据进行了修改，这种修改涉及到表中的全部数据行。
    同时，第二个事务也修改这个表中的数据，这种修改是向表中插入一行新数据。
    那么，以后就会发生操作第一个事务的用户发现表中还有没有修改的数据行，就好象发生了幻觉一样.
    **不可重复读和幻读有些相似，但是前者针对的是update或delete，后者针对的insert。**
  1. 如何解决幻读？
  1. MVCC-多版本事务控制，即在每一行后加上时间戳
       1. 事务每次取数据的时候都会取创建版本小于当前事务版本的数据，以及过期版本大于当前版本的数据。
  1. Next-Key锁（行锁+gap锁）
1. 丢失更新  
两个事务同时读取同一条记录，A先修改记录，B也修改记录（B是不知道A修改过），B提交数据后B的修改结果覆盖了A的修改结果。
### 1.3.2 隔离级别
1. Read Uncommitted（读取未提交内容）
1. Read Committed（读取提交内容）
1. Repeatable Read（可重读）
1. Serializable（可串行化）
## 1.4 持久性（Durability）
持久性，意味着在事务完成以后，该事务所对数据库所作的更改便持久的保存在数据库之中，并不会被回滚。